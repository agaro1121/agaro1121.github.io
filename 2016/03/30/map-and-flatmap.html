<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title>Map and FlatMap</title> <meta name="description" content="Hey guys I&#39;m back. I&#39;ve been real lazy about moving my blog over here but it&#39;s finally done"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="http://yourdomain.com/2016/03/30/map-and-flatmap.html"> <link rel="alternate" type="application/rss+xml" title="Hierro's Blog" href="http://yourdomain.com/feed.xml"> <script src="/assets/js/modernizr.js"></script> </head> <body"> <main class="wrapper"> <header class="site-header"> <a href="#navbar" id="menu-burger" class="menu-burger">Menu <span class="nav-icon"></span> <svg x="0px" y="0px" width="54px" height="54px" viewBox="0 0 54 54"> <circle fill="transparent" stroke="#000000" stroke-width="1" cx="27" cy="27" r="25" stroke-dasharray="157 157" stroke-dashoffset="157"></circle> </svg> </a> <div id="navbar" class="navbar"> <div class="navigation-wrapper"> <div class="half-block"> <h2>Navigation</h2> <nav> <ul class="primary-nav"> <li><a href="/">Home</a></li> <li><a href="/blog">Blog</a></li> <li><a href="/about">About</a></li> <li><a href="http://github.com/agaro1121" target="_blank"><i class="icon icon-github"></i> Github</a></li> <li><a href="http://twitter.com/dametisbrown" target="_blank"><i class="icon icon-twitter"></i> Twitter</a></li> <li><a href="/feed.xml" target="_blank"><i class="icon icon-feed"></i> RSS</a></li> </ul> </nav> </div> </div> </div> </header> <article class="post" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header intro"> <div class="intro-in"> <h1 class="post-title" itemprop="name headline">Map and FlatMap</h1> <p class="post-meta"><time datetime="2016-03-30T07:17:00-05:00" itemprop="datePublished">Mar 30, 2016</time> • <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Anthony Garo</span></span></p> </div> </header> <div class="post-content container" itemprop="articleBody"> <p>Hey guys I&#39;m back. I&#39;ve been real lazy about moving my blog over here but it&#39;s finally done</p> <p>Today I&#39;m going to talk about map and flatmap. For some reason, it took me a while to understand these functions so I wanted to share them with you.</p> <p>The following code examples are in scala and can easily be executed from the scala REPL.</p> <p>For those of you new to scala or a REPL(read, evaluate, print, loop), here&#39;s how you set it up:</p> <p>download <a href="http://www.scala-lang.org/download/">Scala</a> and install it. Once installed, just simply go to your terminal and type <code>scala</code></p> <p>you will be welcomed by the following:</p> <div class="highlight"><pre><code class="language-bash" data-lang="bash">~ &gt; scala
Welcome to Scala 2.11.8 <span class="o">(</span>Java HotSpot<span class="o">(</span>TM<span class="o">)</span> 64-Bit Server VM, Java 1.8.0_60<span class="o">)</span>.
Type in expressions <span class="k">for</span> evaluation. Or try :help.

scala&gt;
</code></pre></div> <p>For those of you who don&#39;t know Functional Programming or are starting to use it now, you&#39;re in for a treat :-)</p> <p>Map and FlatMap usually come bundled with Monads. Monads are specific to functional programming. A Monad is not a type but more of a construct. Many different objects in scala are Monads out of the box because they follow the Monad laws. Lists, Options, and Futures are great examples of Monads in Scala. To put it simply, a Monad is a container with some stuff in it. The Monad gives you the ability to perform operations on the stuff while it&#39;s in the container. Once you&#39;re done operating on your stuff, you can unwrap the Monad and get your result. Whether it succeeded or not.</p> <p>Let&#39;s get right into it.</p> <h3>Map</h3> <p>Goes through every item in your container and performs the specified operation on it.</p> <h4>List</h4> <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">list</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">4</span><span class="o">,</span><span class="mi">5</span><span class="o">,</span><span class="mi">6</span><span class="o">,</span><span class="mi">7</span><span class="o">,</span><span class="mi">8</span><span class="o">,</span><span class="mi">9</span><span class="o">,</span><span class="mi">10</span><span class="o">)</span>
<span class="n">list</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="mi">7</span><span class="o">,</span> <span class="mi">8</span><span class="o">,</span> <span class="mi">9</span><span class="o">,</span> <span class="mi">10</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="n">num</span> <span class="k">=&gt;</span> <span class="n">num</span> <span class="o">*</span> <span class="mi">2</span><span class="o">)</span>
<span class="n">res0</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="mi">8</span><span class="o">,</span> <span class="mi">10</span><span class="o">,</span> <span class="mi">12</span><span class="o">,</span> <span class="mi">14</span><span class="o">,</span> <span class="mi">16</span><span class="o">,</span> <span class="mi">18</span><span class="o">,</span> <span class="mi">20</span><span class="o">)</span>
</code></pre></div> <p>For those of you new to lambda expressions let me clarify some stuff: <code>list.map(num =&gt; num * 2)</code> We&#39;re iterating over every value in our list. <code>num</code> is a reference to the current value the map function will be looking at. At the end, the map function produces a NEW list with the new values. FYI <code>val</code> signifies an IMMUTABLE value in scala so our original list does not change. If you want to retain this value, you need to assign a new <code>val</code> to it.</p> <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">list</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">4</span><span class="o">,</span><span class="mi">5</span><span class="o">,</span><span class="mi">6</span><span class="o">,</span><span class="mi">7</span><span class="o">,</span><span class="mi">8</span><span class="o">,</span><span class="mi">9</span><span class="o">,</span><span class="mi">10</span><span class="o">)</span>
<span class="n">list</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="mi">7</span><span class="o">,</span> <span class="mi">8</span><span class="o">,</span> <span class="mi">9</span><span class="o">,</span> <span class="mi">10</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="n">num</span> <span class="k">=&gt;</span> <span class="n">num</span> <span class="o">*</span> <span class="mi">2</span><span class="o">)</span>
<span class="n">res0</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="mi">8</span><span class="o">,</span> <span class="mi">10</span><span class="o">,</span> <span class="mi">12</span><span class="o">,</span> <span class="mi">14</span><span class="o">,</span> <span class="mi">16</span><span class="o">,</span> <span class="mi">18</span><span class="o">,</span> <span class="mi">20</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">list</span>
<span class="n">res1</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="mi">7</span><span class="o">,</span> <span class="mi">8</span><span class="o">,</span> <span class="mi">9</span><span class="o">,</span> <span class="mi">10</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">list2</span> <span class="k">=</span> <span class="n">list</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="n">num</span> <span class="k">=&gt;</span> <span class="n">num</span> <span class="o">*</span> <span class="mi">2</span><span class="o">)</span>
<span class="n">list2</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="mi">8</span><span class="o">,</span> <span class="mi">10</span><span class="o">,</span> <span class="mi">12</span><span class="o">,</span> <span class="mi">14</span><span class="o">,</span> <span class="mi">16</span><span class="o">,</span> <span class="mi">18</span><span class="o">,</span> <span class="mi">20</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">list2</span>
<span class="n">res2</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="mi">8</span><span class="o">,</span> <span class="mi">10</span><span class="o">,</span> <span class="mi">12</span><span class="o">,</span> <span class="mi">14</span><span class="o">,</span> <span class="mi">16</span><span class="o">,</span> <span class="mi">18</span><span class="o">,</span> <span class="mi">20</span><span class="o">)</span>
</code></pre></div><div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="n">num</span> <span class="k">=&gt;</span> <span class="n">println</span><span class="o">(</span><span class="n">s</span><span class="s">&quot;current number = $num&quot;</span><span class="o">))</span>
<span class="n">current</span> <span class="n">number</span> <span class="k">=</span> <span class="mi">1</span>
<span class="n">current</span> <span class="n">number</span> <span class="k">=</span> <span class="mi">2</span>
<span class="n">current</span> <span class="n">number</span> <span class="k">=</span> <span class="mi">3</span>
<span class="n">current</span> <span class="n">number</span> <span class="k">=</span> <span class="mi">4</span>
<span class="n">current</span> <span class="n">number</span> <span class="k">=</span> <span class="mi">5</span>
<span class="n">current</span> <span class="n">number</span> <span class="k">=</span> <span class="mi">6</span>
<span class="n">current</span> <span class="n">number</span> <span class="k">=</span> <span class="mi">7</span>
<span class="n">current</span> <span class="n">number</span> <span class="k">=</span> <span class="mi">8</span>
<span class="n">current</span> <span class="n">number</span> <span class="k">=</span> <span class="mi">9</span>
<span class="n">current</span> <span class="n">number</span> <span class="k">=</span> <span class="mi">10</span>
<span class="n">res11</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Unit</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">((),</span> <span class="o">(),</span> <span class="o">(),</span> <span class="o">(),</span> <span class="o">(),</span> <span class="o">(),</span> <span class="o">(),</span> <span class="o">(),</span> <span class="o">(),</span> <span class="o">())</span> 
<span class="c1">//println statements return void(nothing) so you get back a list of nothing...notice Unit :-)</span>
<span class="c1">//Unit is basically saying this returns nothing and is a valid return type. </span>
<span class="c1">//You typically would not use void like in other languages</span>
</code></pre></div> <h4>Option Example</h4> <p>I&#39;m not going to go into it too much but an Option in scala is exactly that. You either have something or you don&#39;t. This solves the issue of NullPointerExceptions in Java. At the end of operating on an Option, you either have <code>Some</code> or <code>None</code> Let&#39;s take a look at some code:</p> <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">option</span> <span class="k">=</span> <span class="nc">Option</span><span class="o">(</span><span class="mi">10</span><span class="o">)</span>
<span class="n">option</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Some</span><span class="o">(</span><span class="mi">10</span><span class="o">)</span> <span class="c1">//notice the Some</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">option</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="n">num</span> <span class="k">=&gt;</span> <span class="n">num</span> <span class="o">*</span> <span class="mi">2</span><span class="o">)</span>
<span class="n">res3</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Some</span><span class="o">(</span><span class="mi">20</span><span class="o">)</span> <span class="c1">//notice the Some again</span>
</code></pre></div> <p>As you&#39;ve noticed, we used the EXACT same map function over the Option. You can picture an Option of just simply a list of 1 item. Only difference it&#39;s either there or not.</p> <p>Let&#39;s see what happens when it is not there or we perform a bad operation on it.</p> <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">none</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">None</span>
<span class="n">none</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">None</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">none</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="n">num</span> <span class="k">=&gt;</span> <span class="n">num</span> <span class="o">*</span> <span class="mi">2</span><span class="o">)</span>
<span class="n">res0</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">None</span>
</code></pre></div> <p>Some things to note about the code above.</p> <p><code>val none: Option[Int]</code> here we are specifying that the variable none will be of type Option[Int] </p> <p>We then set it to None to signify there is nothing there. As you can see when we tried to multiply nothing * 2, the compiler did not freak out but simply returned None to us to show there is nothing there This is just for simply giving an example but if this were a database retrieval, json/xml being converted into an object, then it could get ugly if an Option were not used here.</p> <h3>FlatMap</h3> <p>Let&#39;s look at flatMap now. FlatMap is a combination of map and another function called flatten. It works just like map but it calls the flatten function for you. It&#39;s better if I showed you.</p> <h4>List</h4> <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">list</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">)</span>
<span class="n">list</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="n">num</span> <span class="k">=&gt;</span> <span class="nc">List</span><span class="o">(</span><span class="n">num</span><span class="o">-</span><span class="mi">1</span><span class="o">,</span><span class="n">num</span><span class="o">,</span><span class="n">num</span><span class="o">+</span><span class="mi">1</span><span class="o">))</span>
<span class="n">res0</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="nc">List</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">),</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">),</span> <span class="nc">List</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">))</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="n">num</span> <span class="k">=&gt;</span> <span class="nc">List</span><span class="o">(</span><span class="n">num</span><span class="o">-</span><span class="mi">1</span><span class="o">,</span><span class="n">num</span><span class="o">,</span><span class="n">num</span><span class="o">+</span><span class="mi">1</span><span class="o">)).</span><span class="n">flatten</span>
<span class="n">res1</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">.</span><span class="n">flatMap</span><span class="o">(</span><span class="n">num</span> <span class="k">=&gt;</span> <span class="nc">List</span><span class="o">(</span><span class="n">num</span><span class="o">-</span><span class="mi">1</span><span class="o">,</span><span class="n">num</span><span class="o">,</span><span class="n">num</span><span class="o">+</span><span class="mi">1</span><span class="o">))</span>
<span class="n">res2</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">)</span>
</code></pre></div> <p>The example above starts off with <code>val list = List(1,2,3)</code></p> <p>Then it goes on to map over it and produce a list for every number in the original list. Each mini list contains the number and it&#39;s left and right neighbors.</p> <p>If for some reason you wanted to take all these lists and convert them into one giant list again then you would call flatten as you can see.</p> <p>The flatMap takes that complexity away and does it for you in one shot.</p> <p>We went from <code>List[Int]</code> to <code>List[List[Int]]</code> and back to <code>List[Int]</code></p> <h4>Option</h4> <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">option</span> <span class="k">=</span> <span class="nc">Option</span><span class="o">(</span><span class="mi">10</span><span class="o">)</span>
<span class="n">option</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Some</span><span class="o">(</span><span class="mi">10</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">option</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="n">num</span> <span class="k">=&gt;</span> <span class="nc">Option</span><span class="o">(</span><span class="n">num</span> <span class="o">*</span> <span class="mi">2</span><span class="o">))</span>
<span class="n">res3</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Option</span><span class="o">[</span><span class="kt">Int</span><span class="o">]]</span> <span class="k">=</span> <span class="nc">Some</span><span class="o">(</span><span class="nc">Some</span><span class="o">(</span><span class="mi">20</span><span class="o">))</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">option</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="n">num</span> <span class="k">=&gt;</span> <span class="nc">Option</span><span class="o">(</span><span class="n">num</span> <span class="o">*</span> <span class="mi">2</span><span class="o">)).</span><span class="n">flatten</span>
<span class="n">res4</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Some</span><span class="o">(</span><span class="mi">20</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">option</span><span class="o">.</span><span class="n">flatMap</span><span class="o">(</span><span class="n">num</span> <span class="k">=&gt;</span> <span class="nc">Option</span><span class="o">(</span><span class="n">num</span> <span class="o">*</span> <span class="mi">2</span><span class="o">))</span>
<span class="n">res5</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Some</span><span class="o">(</span><span class="mi">20</span><span class="o">)</span>
</code></pre></div> <p>As you can see with the Option, it is the exact same thing.</p> <p>Going from <code>Option[Int]</code> to <code>Option[Option[Int]]</code> and back to <code>Option[Int]</code></p> <p>You&#39;re probably asking when would you ever see something like this. I&#39;ll demonstrate with a more realistic example.</p> <p>Let&#39;s imagine a structure where you have a client management system. That customer may or may not have an address. The address may or may not have a zip code depending on which country you&#39;re in(some international countries don&#39;t require zip codes in addresses).</p> <p>Before we begin the example, some basic info about the code we are going to use.</p> <h4>The case class</h4> <p>the case class is the equivalent of a plain old object with fields in it. No functions or behavior/state changing things should be here. The term case class is a scala thing but the concept is natural to other languages. Some of us call them POJOs(plain old java objects) or DTOs(Data Transfer Object)</p> <p>The cool thing about case classes in scala is that they automatically come with an equals method and toString method. Another cool thing is you don&#39;t have to use the keyword <code>new</code> to create a new object from a case class or create getters/setters because they&#39;re made for you</p> <h5>Defining our stuff</h5> <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">Address</span><span class="o">(</span><span class="n">add1</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">add2</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">postalCode</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span>
<span class="n">defined</span> <span class="k">class</span> <span class="nc">Address</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">Client</span><span class="o">(</span><span class="n">name</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">add</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Address</span><span class="o">])</span>
<span class="n">defined</span> <span class="k">class</span> <span class="nc">Client</span>
</code></pre></div> <h5>Creating clients</h5> <p>We&#39;ll create 3 clients. One with an address with a postal code and one with an address without a postal code. And a third with no address.</p> <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="c1">//Address</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">addWithPostal</span> <span class="k">=</span> <span class="nc">Address</span><span class="o">(</span><span class="s">&quot;address1&quot;</span><span class="o">,</span><span class="s">&quot;address2&quot;</span><span class="o">,</span> <span class="nc">Some</span><span class="o">(</span><span class="s">&quot;postalCode&quot;</span><span class="o">))</span>
<span class="n">addWithPostal</span><span class="k">:</span> <span class="kt">Address</span> <span class="o">=</span> <span class="nc">Address</span><span class="o">(</span><span class="n">address1</span><span class="o">,</span><span class="n">address2</span><span class="o">,</span><span class="nc">Some</span><span class="o">(</span><span class="n">postalCode</span><span class="o">))</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">addWithNoPostal</span> <span class="k">=</span> <span class="nc">Address</span><span class="o">(</span><span class="s">&quot;address1&quot;</span><span class="o">,</span><span class="s">&quot;address2&quot;</span><span class="o">,</span><span class="nc">None</span><span class="o">)</span>
<span class="n">addWithNoPostal</span><span class="k">:</span> <span class="kt">Address</span> <span class="o">=</span> <span class="nc">Address</span><span class="o">(</span><span class="n">address1</span><span class="o">,</span><span class="n">address2</span><span class="o">,</span><span class="nc">None</span><span class="o">)</span>

<span class="c1">//Clients</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">clientWithNoAdd</span> <span class="k">=</span> <span class="nc">Client</span><span class="o">(</span><span class="s">&quot;client1&quot;</span><span class="o">,</span><span class="nc">None</span><span class="o">)</span>
<span class="n">clientWithNoAdd</span><span class="k">:</span> <span class="kt">Client</span> <span class="o">=</span> <span class="nc">Client</span><span class="o">(</span><span class="n">client1</span><span class="o">,</span><span class="nc">None</span><span class="o">)</span> 

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">clientWithNoPostal</span> <span class="k">=</span> <span class="nc">Client</span><span class="o">(</span><span class="s">&quot;client2&quot;</span><span class="o">,</span> <span class="nc">Some</span><span class="o">(</span><span class="n">addWithNoPostal</span><span class="o">))</span>
<span class="n">clientWithNoPostal</span><span class="k">:</span> <span class="kt">Client</span> <span class="o">=</span> <span class="nc">Client</span><span class="o">(</span><span class="n">client2</span><span class="o">,</span><span class="nc">Some</span><span class="o">(</span><span class="nc">Address</span><span class="o">(</span><span class="n">address1</span><span class="o">,</span><span class="n">address2</span><span class="o">,</span><span class="nc">None</span><span class="o">)))</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">clientWithPostal</span> <span class="k">=</span> <span class="nc">Client</span><span class="o">(</span><span class="s">&quot;client3&quot;</span><span class="o">,</span><span class="nc">Some</span><span class="o">(</span><span class="n">addWithPostal</span><span class="o">))</span>
<span class="n">clientWithPostal</span><span class="k">:</span> <span class="kt">Client</span> <span class="o">=</span> <span class="nc">Client</span><span class="o">(</span><span class="n">client3</span><span class="o">,</span><span class="nc">Some</span><span class="o">(</span><span class="nc">Address</span><span class="o">(</span><span class="n">address1</span><span class="o">,</span><span class="n">address2</span><span class="o">,</span><span class="nc">Some</span><span class="o">(</span><span class="n">postalCode</span><span class="o">))))</span>
</code></pre></div> <p>Ok we&#39;re all set up. Now the fun part. I want to print out the postal code for all my clients</p> <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="n">clientWithNoPostal</span><span class="o">.</span><span class="n">add</span> <span class="c1">//this is an option so we need to map over it to get to it&#39;s value and operate</span>
        <span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="n">address</span> <span class="k">=&gt;</span> <span class="n">address</span><span class="o">.</span><span class="n">postalCode</span> <span class="c1">//postalCode is also an option</span>
            <span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="n">postal</span> <span class="k">=&gt;</span> <span class="n">println</span><span class="o">(</span><span class="n">postal</span><span class="o">)))</span>
<span class="n">res7</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Option</span><span class="o">[</span><span class="kt">Unit</span><span class="o">]]</span> <span class="k">=</span> <span class="nc">Some</span><span class="o">(</span><span class="nc">None</span><span class="o">)</span>         
</code></pre></div> <p>As you can see above that resulted in <code>Option[Option[Unit]] = Some(None)</code> We&#39;re still not there yet. Let&#39;s flatten it.</p> <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="n">clientWithNoPostal</span><span class="o">.</span><span class="n">add</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="n">address</span> <span class="k">=&gt;</span> <span class="n">address</span><span class="o">.</span><span class="n">postalCode</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="n">postal</span> <span class="k">=&gt;</span> <span class="n">println</span><span class="o">(</span><span class="n">postal</span><span class="o">))).</span><span class="n">flatten</span>
<span class="n">res8</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Unit</span><span class="o">]</span> <span class="k">=</span> <span class="nc">None</span>
</code></pre></div> <p>And as you know, this can all be done from flatMap</p> <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="n">clientWithNoPostal</span><span class="o">.</span><span class="n">add</span><span class="o">.</span><span class="n">flatMap</span><span class="o">(</span><span class="n">address</span> <span class="k">=&gt;</span> <span class="n">address</span><span class="o">.</span><span class="n">postalCode</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="n">postal</span> <span class="k">=&gt;</span> <span class="n">println</span><span class="o">(</span><span class="n">postal</span><span class="o">)))</span>
<span class="n">res9</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Unit</span><span class="o">]</span> <span class="k">=</span> <span class="nc">None</span>
</code></pre></div> <p>As you can see, there was no need for null checks or Exceptions being thrown. The code simply handled everything. But most importantly, this is a real scenario of when there are heirarchies that may have optional values in a chain</p> <p>Let&#39;s look at the other examples for completion</p> <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="n">clientWithPostal</span><span class="o">.</span><span class="n">add</span><span class="o">.</span><span class="n">flatMap</span><span class="o">(</span><span class="n">address</span> <span class="k">=&gt;</span> <span class="n">address</span><span class="o">.</span><span class="n">postalCode</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="n">postal</span> <span class="k">=&gt;</span> <span class="n">println</span><span class="o">(</span><span class="n">postal</span><span class="o">)))</span>
<span class="n">postalCode</span>
<span class="n">res10</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Unit</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Some</span><span class="o">(())</span> <span class="c1">//Again notice the empty Some(()) because println returns nothing</span>
</code></pre></div> <p>If you simply wanted to get the value, you can See below:</p> <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="n">clientWithPostal</span><span class="o">.</span><span class="n">add</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="n">address</span> <span class="k">=&gt;</span> <span class="n">address</span><span class="o">.</span><span class="n">postalCode</span><span class="o">)</span>
<span class="n">res14</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Option</span><span class="o">[</span><span class="kt">String</span><span class="o">]]</span> <span class="k">=</span> <span class="nc">Some</span><span class="o">(</span><span class="nc">Some</span><span class="o">(</span><span class="n">postalCode</span><span class="o">))</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">clientWithPostal</span><span class="o">.</span><span class="n">add</span><span class="o">.</span><span class="n">flatMap</span><span class="o">(</span><span class="n">address</span> <span class="k">=&gt;</span> <span class="n">address</span><span class="o">.</span><span class="n">postalCode</span><span class="o">)</span>
<span class="n">res13</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Some</span><span class="o">(</span><span class="n">postalCode</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">clientWithPostal</span><span class="o">.</span><span class="n">add</span><span class="o">.</span><span class="n">flatMap</span><span class="o">(</span><span class="n">address</span> <span class="k">=&gt;</span> <span class="n">address</span><span class="o">.</span><span class="n">postalCode</span><span class="o">).</span><span class="n">get</span><span class="c1">//will throw an exception if no value is there</span>
<span class="n">res16</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">postalCode</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">clientWithPostal</span><span class="o">.</span><span class="n">add</span><span class="o">.</span><span class="n">flatMap</span><span class="o">(</span><span class="n">address</span> <span class="k">=&gt;</span> <span class="n">address</span><span class="o">.</span><span class="n">postalCode</span><span class="o">).</span><span class="n">getOrElse</span><span class="o">(</span><span class="s">&quot;noPostal&quot;</span><span class="o">)</span><span class="c1">//avoid exception with default value</span>
<span class="n">res15</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">postalCode</span>
</code></pre></div><div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="n">clientWithNoAdd</span><span class="o">.</span><span class="n">add</span><span class="o">.</span><span class="n">flatMap</span><span class="o">(</span><span class="n">address</span> <span class="k">=&gt;</span> <span class="n">address</span><span class="o">.</span><span class="n">postalCode</span><span class="o">)</span>
<span class="n">res17</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">None</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">clientWithNoAdd</span><span class="o">.</span><span class="n">add</span><span class="o">.</span><span class="n">flatMap</span><span class="o">(</span><span class="n">address</span> <span class="k">=&gt;</span> <span class="n">address</span><span class="o">.</span><span class="n">postalCode</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="n">postal</span> <span class="k">=&gt;</span> <span class="n">println</span><span class="o">(</span><span class="n">postal</span><span class="o">)))</span>
<span class="n">res18</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Unit</span><span class="o">]</span> <span class="k">=</span> <span class="nc">None</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">clientWithNoAdd</span><span class="o">.</span><span class="n">add</span><span class="o">.</span><span class="n">flatMap</span><span class="o">(</span><span class="n">address</span> <span class="k">=&gt;</span> <span class="n">address</span><span class="o">.</span><span class="n">postalCode</span><span class="o">).</span><span class="n">get</span>
<span class="n">java</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="nc">NoSuchElementException</span><span class="k">:</span> <span class="kt">None.get</span>
  <span class="n">at</span> <span class="n">scala</span><span class="o">.</span><span class="nc">None</span><span class="n">$</span><span class="o">.</span><span class="n">get</span><span class="o">(</span><span class="nc">Option</span><span class="o">.</span><span class="n">scala</span><span class="k">:</span><span class="err">347</span><span class="o">)</span>
  <span class="n">at</span> <span class="n">scala</span><span class="o">.</span><span class="nc">None</span><span class="n">$</span><span class="o">.</span><span class="n">get</span><span class="o">(</span><span class="nc">Option</span><span class="o">.</span><span class="n">scala</span><span class="k">:</span><span class="err">345</span><span class="o">)</span>
  <span class="o">...</span> <span class="mi">32</span> <span class="n">elided</span>
<span class="c1">//throws exception because you&#39;re trying to get an element from Nothing  </span>
</code></pre></div> <p>As you can see from the above example, we tried to get to the postal code but this user has no address to begin with.</p> <p>The container knows that there is no address, so it returns the result of that and does not go any further down the chain to retrieve the postal code</p> <p>In the very last line, I tried to get something from Nothing so the compiler threw an exception</p> <h2>Well that&#39;s all for today! See you again next time !!!</h2> </div> </article> <footer class="site-footer"> <div class="container"> <ul class="social"> <li><a href="http://github.com/agaro1121" target="_blank"><i class="icon icon-github"></i></a></li> <li><a href="http://linkedin.com/in/anthony-garo-b9781636" target="_blank"><i class="icon icon-linkedin"></i></a></li> <li><a href="http://twitter.com/dametisbrown" target="_blank"><i class="icon icon-twitter"></i></a></li> </ul> <p> <small>&copy;2016 All rights reserved. Made with <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> and ♥</small> </p> </div> </footer> </main> <script src="/assets/js/jquery-2.1.1.js"></script> <script src="/assets/js/main.js"></script> </body> </html><!-- by nandomoreira.me -->